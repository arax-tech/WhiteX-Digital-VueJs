import{r as w,e as Z}from"./validators-dea6e3a5.js";import{q as H,L as K,n as Q,a4 as W,s as U,t as D,a0 as X,r as c,o as u,f as x,e as s,b as t,d as l,ag as O,a1 as N,E as R,D as ee,z as i,a2 as A,x as ae,aj as te,c as f,C as E,G as M,F}from"./index-c4e71550.js";import{_ as le}from"./AppTextField-a8f30c8f.js";import{_ as se}from"./Loading-2eec0421.js";import{A as y}from"./Permission-403ee5c6.js";import{a as m,V as $}from"./VRow-3a397f81.js";import{V as j}from"./VCardText-6669d6f5.js";import{V as oe}from"./VDivider-aef533a2.js";import{V as ne}from"./VForm-617abc97.js";import{V as ie}from"./VFileInput-134ee4d3.js";import{V as re}from"./VTable-28a89234.js";import{V as de}from"./VCard-71b3ac17.js";import"./helpers-61e4df1a.js";import"./focus-ba6d54b4.js";import"./VTextField-47e6f93c.js";/* empty css                   */import"./VCounter-856e1893.js";import"./VImg-8451f417.js";import"./VField-0f4003e5.js";import"./easing-9f15041e.js";import"./VInput-6532c874.js";import"./form-d2acef44.js";import"./forwardRefs-8348545e.js";import"./VAvatar-0d338c12.js";import"./VChip-a642ea45.js";const ue=l("div",null,[l("h2",null,"Update Admin")],-1),ce={style:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},me=l("h2",{class:"mb-2"},"Permissions",-1),pe=l("label",{for:"checkAll"},"Â All Permission",-1),fe=l("thead",null,[l("tr",null,[l("th",{scope:"col"},"Modal"),l("th",{scope:"col"},"Create"),l("th",{scope:"col"},"Read"),l("th",{scope:"col"},"Update"),l("th",{scope:"col"},"Delete")])],-1),he={key:0},ve=["value","checked","onChange"],Ve={key:1},Te={__name:"[id]",setup(_e){const p=H(),P=K(),q=Q(),B=W.useToast();U(()=>document.title="Admin - Create Admin");const k=D(()=>p.state.admins.loading),z=D(()=>p.state.admins.admin);X(async()=>{await p.dispatch("GetSingleAdminAction",q.params.id),J()});const G=D(()=>p.state.auth.user),I=JSON.parse(G.value.permissions);U(()=>{var e;(e=I.Admin)!=null&&e.includes("UpdateAdmin")||(alert("You don't have permission to access this resource..."),P.go(-1))});const h=c(""),v=c(""),V=c(""),C=c(null),_=c(),o=c({}),J=()=>{const e=z.value;if(e){h.value=e.name,v.value=e.email,V.value=e.designation;const a=JSON.parse(e.permissions);for(const r in y)o.value[r]=a[r]||[]}},S=()=>{for(const e in y)o.value[e]=g.value?y[e].permissions.slice():[]},g=c(!1);U(()=>{S()});const L=async()=>{const e=new FormData;e.append("name",h.value),e.append("email",v.value),e.append("designation",V.value),e.append("permissions",JSON.stringify(o==null?void 0:o.value)),C.value&&e.append("image",C.value);try{const a=await p.dispatch("UpdateAdminAction",{id:q.params.id,formData:e});B.success(a.message),p.dispatch("GetAuthUser"),P.push("/admin/admin")}catch(a){console.error(a),B.error(a.message)}},T=(e,a)=>{if(o.value.hasOwnProperty(e)){const r=o.value[e].indexOf(a);r!==-1?o.value[e].splice(r,1):o.value[e].push(a)}},Y=()=>{var e;(e=_==null?void 0:_.value)==null||e.validate().then(({valid:a})=>{a&&L()})};return(e,a)=>{const r=le;return u(),x($,null,{default:s(()=>[k.value?(u(),x(se,{key:0})):(u(),x(m,{key:1,cols:"12"},{default:s(()=>[t(de,null,{default:s(()=>[t(j,{style:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},{default:s(()=>[ue,l("div",null,[t(O,{to:"/admin/admin",rounded:"pill",color:"primary",size:"small",class:"ml-5"},{default:s(()=>[t(N,{start:"",icon:"tabler-arrow-left"}),R("Back ")]),_:1})])]),_:1}),t(oe),t(j,{class:"pt-0"},{default:s(()=>[t(ne,{class:"mt-6",ref_key:"refForm",ref:_,onSubmit:ee(Y,["prevent"])},{default:s(()=>[t($,null,{default:s(()=>[t(m,{cols:"12",md:"6"},{default:s(()=>[t(r,{modelValue:i(h),"onUpdate:modelValue":a[0]||(a[0]=n=>A(h)?h.value=n:null),"prepend-inner-icon":"tabler-user",placeholder:"Name","persistent-placeholder":"",label:"Name",rules:["requiredValidator"in e?e.requiredValidator:i(w)]},null,8,["modelValue","rules"])]),_:1}),t(m,{cols:"12",md:"6"},{default:s(()=>[t(r,{modelValue:i(v),"onUpdate:modelValue":a[1]||(a[1]=n=>A(v)?v.value=n:null),"prepend-inner-icon":"tabler-mail",placeholder:"Email","persistent-placeholder":"",label:"Email",rules:["requiredValidator"in e?e.requiredValidator:i(w),"emailValidator"in e?e.emailValidator:i(Z)]},null,8,["modelValue","rules"])]),_:1}),t(m,{cols:"12",md:"6"},{default:s(()=>[t(r,{modelValue:i(V),"onUpdate:modelValue":a[2]||(a[2]=n=>A(V)?V.value=n:null),"prepend-inner-icon":"tabler-id",placeholder:"Designation","persistent-placeholder":"",label:"Designation",rules:["requiredValidator"in e?e.requiredValidator:i(w)]},null,8,["modelValue","rules"])]),_:1}),t(m,{cols:"12",md:"6",class:"mt-6"},{default:s(()=>[t(ie,{label:"Profile Picture",variant:"filled",onChange:a[3]||(a[3]=n=>C.value=n.target.files[0])})]),_:1}),t(m,{cols:"12",md:"12",class:"mt-6"},{default:s(()=>[l("div",ce,[me,l("div",null,[ae(l("input",{id:"checkAll",type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=n=>A(g)?g.value=n:null),onChange:S},null,544),[[te,i(g)]]),pe])]),t(re,{class:"text-no-wrap rounded border"},{default:s(()=>[fe,l("tbody",null,[(u(!0),f(F,null,E(i(y),(n,d)=>(u(),f("tr",{key:d},[l("td",null,M(d.replace(/([a-z])([A-Z])/g,"$1 $2")),1),(u(),f(F,null,E(["Create","Read","Update","Delete"],b=>(u(),f(F,null,[n.permissions.includes(b+d)?(u(),f("td",he,[l("input",{type:"checkbox",value:b+d,class:"checkbox",checked:i(o)[d]&&i(o)[d].includes(b+d),onChange:ge=>T(d,b+d)},null,40,ve)])):(u(),f("td",Ve))],64))),64))]))),128))])]),_:1})]),_:1}),t(m,{cols:"12"},{default:s(()=>[t(O,{type:"submit",disabled:k.value},{default:s(()=>[R(M(k.value?"Updating...":"Update"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1}))]),_:1})}}};export{Te as default};
