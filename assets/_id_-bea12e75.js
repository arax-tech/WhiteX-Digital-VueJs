import{q as j,L as z,n as E,a4 as G,s as _,t as v,r as x,a0 as L,o as c,f as C,e as a,b as o,d as e,ag as b,a1 as T,E as w,D as q,x as I,aj as Y,z as f,a2 as Z,c as d,C as D,G as U,F as k}from"./index-35d4c811.js";import{_ as H}from"./Loading-891177bd.js";import{C as m}from"./Permission-f91c8685.js";import{a as y,V as A}from"./VRow-d67d386c.js";import{V as P}from"./VCardText-20e2d0ff.js";import{V as K}from"./VDivider-4423ace3.js";import{V as Q}from"./VForm-790819b5.js";import{V as W}from"./VTable-41351eee.js";import{V as X}from"./VCard-06d56730.js";import"./VAvatar-7759ad5c.js";import"./VImg-9b04c05e.js";import"./form-ff0dacbf.js";import"./forwardRefs-8348545e.js";const N=e("div",null,[e("h2",null,"Update Client")],-1),ee={style:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},te=e("h2",{class:"mb-2"},"Permissions",-1),se=e("label",{for:"checkAll"},"Â All Permission",-1),ae=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Modal"),e("th",{scope:"col"},"Create"),e("th",{scope:"col"},"Read"),e("th",{scope:"col"},"Update"),e("th",{scope:"col"},"Delete")])],-1),oe={key:0},ne=["value","checked","onChange"],le={key:1},Ve={__name:"[id]",setup(ie){const r=j(),S=z(),g=E(),B=G.useToast();_(()=>document.title="Admin - Update Client"),_(()=>V());const h=v(()=>r.state.clients.loading),O=v(()=>r.state.clients.client),R=v(()=>r.state.auth.user),F=JSON.parse(R.value.permissions);_(()=>{var t;(t=F.Client)!=null&&t.includes("UpdateClient")||(alert("You don't have permission to access this resource..."),S.go(-1))});const n=x({}),u=x(!1),V=()=>{for(const t in m)n.value[t]=u.value?m[t].permissions.slice():[]};L(async()=>{await r.dispatch("GetSingleClientAction",g.params.id),M()});const M=()=>{const t=O.value;if(t){const s=JSON.parse(t.permissions);for(const l in m)n.value[l]=s[l]||[]}},J=async()=>{const t=new FormData;t.append("permissions",JSON.stringify(n.value)),console.log(JSON.stringify(n.value));try{const s=await r.dispatch("UpdateClientAction",{id:g.params.id,formData:t});s.status===200&&(B.success(s.message),r.dispatch("GetTeams"))}catch(s){console.error(s)}},$=(t,s)=>{if(n.value.hasOwnProperty(t)){const l=n.value[t].indexOf(s);l!==-1?n.value[t].splice(l,1):n.value[t].push(s)}};return(t,s)=>(c(),C(A,null,{default:a(()=>[h.value?(c(),C(H,{key:0})):(c(),C(y,{key:1,cols:"12"},{default:a(()=>[o(X,null,{default:a(()=>[o(P,{style:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},{default:a(()=>[N,e("div",null,[o(b,{to:"/admin/client",rounded:"pill",color:"primary",size:"small",class:"ml-5"},{default:a(()=>[o(T,{start:"",icon:"tabler-arrow-left"}),w("Back ")]),_:1})])]),_:1}),o(K),o(P,{class:"pt-0"},{default:a(()=>[o(Q,{class:"mt-6",onSubmit:q(J,["prevent"])},{default:a(()=>[o(A,null,{default:a(()=>[o(y,{cols:"12",md:"12",class:"mt-6"},{default:a(()=>[e("div",ee,[te,e("div",null,[I(e("input",{id:"checkAll",type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=l=>Z(u)?u.value=l:null),onChange:V},null,544),[[Y,f(u)]]),se])]),o(W,{class:"text-no-wrap rounded border"},{default:a(()=>[ae,e("tbody",null,[(c(!0),d(k,null,D(f(m),(l,i)=>(c(),d("tr",{key:i},[e("td",null,U(i.replace(/([a-z])([A-Z])/g,"$1 $2")),1),(c(),d(k,null,D(["Create","Read","Update","Delete"],p=>(c(),d(k,null,[l.permissions.includes(p+i)?(c(),d("td",oe,[e("input",{type:"checkbox",value:p+i,class:"checkbox",checked:f(n)[i]&&f(n)[i].includes(p+i),onChange:ce=>$(i,p+i)},null,40,ne)])):(c(),d("td",le))],64))),64))]))),128))])]),_:1})]),_:1}),o(y,{cols:"12"},{default:a(()=>[o(b,{type:"submit",disabled:h.value},{default:a(()=>[w(U(h.value?"Updating...":"Update"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1}))}};export{Ve as default};
