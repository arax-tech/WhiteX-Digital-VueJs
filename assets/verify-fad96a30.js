import{r as P}from"./validators-dea6e3a5.js";import{q,a4 as A,s as B,L as D,n as O,r as n,t as R,o as C,f as F,e as a,b as t,d as l,z as o,D as M,a2 as S,ag as j,E as N,G as E,ab as d}from"./index-c4e71550.js";import{_ as G}from"./AppTextField-a8f30c8f.js";import{u as V}from"./useGenerateImageVariant-e1eabe90.js";import{a as z,b as U,c as $,d as H}from"./auth-v2-login-illustration-light-19d5c0bb.js";import{a as J,b as K}from"./misc-mask-light-1aeffaee.js";import{u as Q}from"./useAbility-f76e4faf.js";import{V as _}from"./VImg-8451f417.js";import{a as i,V as g}from"./VRow-3a397f81.js";import{V as W}from"./VCard-71b3ac17.js";import{V as y}from"./VCardText-6669d6f5.js";import{V as X}from"./VForm-617abc97.js";import"./helpers-61e4df1a.js";import"./focus-ba6d54b4.js";import"./VTextField-47e6f93c.js";/* empty css                   */import"./VCounter-856e1893.js";import"./VField-0f4003e5.js";import"./easing-9f15041e.js";import"./VInput-6532c874.js";import"./form-d2acef44.js";import"./forwardRefs-8348545e.js";import"./VAvatar-0d338c12.js";const Y={class:"position-relative bg-background rounded-lg w-100 ma-8 me-0"},Z={class:"d-flex align-center justify-center w-100 h-100"},ee=l("h4",{class:"text-h4 mb-1"}," OTP Verification ",-1),te=l("p",{class:"mb-0"}," Please check you email we have send you OTP there... ",-1),Le={__name:"verify",setup(ae){const m=q(),u=A.useToast(),b=V(H,$,U,z,!0),v=V(K,J);B(()=>document.title="Verify"),D();const k=Q(),c=O(),T=n({otp:void 0}),f=n(),p=[{action:"manage",subject:"all"}],h=R(()=>m.state.auth.loading),r=n(null),w=async()=>{var s;try{const e=await m.dispatch("VerifyOTPAction",r.value);e.status===202?(u.success(e.message),d("userAbilityRules").value=p,k.update(p),d("userData").value=e==null?void 0:e.user,d("accessToken").value=e==null?void 0:e.token,window.location.href=c.query.to?String(c.query.to):((s=e==null?void 0:e.user)==null?void 0:s.role)==="Admin"?"/admin/dashboard":"/client/dashboard"):(e.status,u.error(e.message))}catch(e){console.log(e)}},x=()=>{var s;(s=f.value)==null||s.validate().then(({valid:e})=>{e&&w()})};return(s,e)=>{const L=G;return C(),F(g,{"no-gutters":"",class:"auth-wrapper bg-surface"},{default:a(()=>[t(i,{lg:"8",class:"d-none d-lg-flex"},{default:a(()=>[l("div",Y,[l("div",Z,[t(_,{"max-width":"505",src:o(b),class:"auth-illustration mt-16 mb-2"},null,8,["src"])]),t(_,{src:o(v),class:"auth-footer-mask"},null,8,["src"])])]),_:1}),t(i,{cols:"12",lg:"4",class:"auth-card-v2 d-flex align-center justify-center"},{default:a(()=>[t(W,{flat:"","max-width":500,class:"mt-12 mt-sm-0 pa-4"},{default:a(()=>[t(y,null,{default:a(()=>[ee,te]),_:1}),t(y,null,{default:a(()=>[t(o(X),{ref_key:"refVForm",ref:f,onSubmit:M(x,["prevent"])},{default:a(()=>[t(g,null,{default:a(()=>[t(i,{cols:"12"},{default:a(()=>[t(L,{modelValue:o(r),"onUpdate:modelValue":e[0]||(e[0]=I=>S(r)?r.value=I:null),label:"OTP",placeholder:"OTP",type:"number",autofocus:"",rules:["requiredValidator"in s?s.requiredValidator:o(P)],"error-messages":o(T).otp},null,8,["modelValue","rules","error-messages"])]),_:1}),t(i,{cols:"12"},{default:a(()=>[t(j,{block:"",type:"submit",disabled:h.value},{default:a(()=>[N(E(h.value?"Verifying...":"Verify"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})}}};export{Le as default};
