import{_ as I}from"./AppTextField-803105de.js";import{q as M,n as N,a4 as A,s as y,a0 as E,r as V,t as u,o as m,f as G,e as t,b as s,d as o,c as b,C as R,I as n,G as S,z as C,F as q,D as j,a2 as L,ag as U,a1 as $,E as H}from"./index-670bda14.js";import{h as J}from"./moment-a9aaa855.js";import{V as K}from"./VCard-367227de.js";import{V as O}from"./VCardText-83b6dd60.js";import{V as w,a as k}from"./VRow-44af3a5b.js";import{V as P}from"./VAvatar-eedc1aa8.js";import{V as Q}from"./VImg-4f1dd734.js";import{V as W}from"./VForm-e3bcef70.js";import"./focus-bfe812d1.js";import"./VTextField-babd124d.js";/* empty css                   */import"./VCounter-40602143.js";import"./VField-eebd85ff.js";import"./easing-9f15041e.js";import"./VInput-28c68c55.js";import"./form-f40ca62b.js";import"./forwardRefs-8348545e.js";const X=o("h2",null,"Support Tickets Chat",-1),Y={class:"chat-log pa-5",style:{height:"50vh","overflow-y":"scroll"}},Z={class:"chat-avatar ms-4"},h={class:"text-sm ms-1 text-disabled"},ye={__name:"[id]",setup(ee){const a=M(),d=N(),_=A.useToast();y(()=>document.title="Admin - Support Tickets Chat"),E(()=>a.dispatch("GetSingleSupport",d.params.id));const T=V(null);y(()=>{T.value=setInterval(()=>{a.dispatch("GetSingleSupport",d.params.id)},3e3)}),u(()=>a.state.singleSupport.loading);const i=u(()=>a.state.auth.user),B=u(()=>a.state.singleSupport.chats),l=V(""),F=async()=>{if(l.value.length===0)_.error("Message is required...");else{const p=new FormData;p.append("content",l.value);try{const r=await a.dispatch("CreateSupportChat",{id:d.params.id,formData:p});r.status===200&&(_.success(r.message),l.value="")}catch(r){console.error(r)}}};return(p,r)=>{const z=I;return m(),G(w,null,{default:t(()=>[s(k,{cols:"12"},{default:t(()=>[s(K,null,{default:t(()=>[s(O,{style:{"border-bottom":"thin solid rgba(var(--v-border-color), var(--v-border-opacity))"}},{default:t(()=>[s(w,null,{default:t(()=>[s(k,{cols:"8",md:"8"},{default:t(()=>[X]),_:1})]),_:1})]),_:1}),o("div",Y,[(m(!0),b(q,null,R(B.value,(e,D)=>{var c,f,g,v;return m(),b("div",{key:D,class:n(["chat-group d-flex align-start",(e==null?void 0:e.user_id)===((c=i.value)==null?void 0:c.id)?"flex-row-reverse":""])},[o("div",Z,[s(P,{size:"32"},{default:t(()=>{var x;return[s(Q,{src:((x=e==null?void 0:e.user_image)==null?void 0:x.length)>0?e==null?void 0:e.user_image:"/placeholder.jpg"},null,8,["src"])]}),_:2},1024)]),o("div",{class:n(["chat-body d-inline-flex flex-column mb-3",(e==null?void 0:e.user_id)===((f=i.value)==null?void 0:f.id)?"align-end":"align-start"])},[o("p",{class:n(["chat-content py-2 px-4 elevation-1 mb-0",(e==null?void 0:e.user_id)===((g=i.value)==null?void 0:g.id)?"bg-primary text-white chat-right":"sender_bg chat-left ml-3"])},S(e==null?void 0:e.content),3),o("div",{class:n((e==null?void 0:e.user_id)===((v=i.value)==null?void 0:v.id)?"text-right":"ml-2")},[o("span",h,S(C(J)(e==null?void 0:e.created_at).fromNow()),1)],2)],2)],2)}),128))]),s(W,{class:"p-5 d-flex flex-row mt-5",style:{padding:"20px"},onSubmit:j(F,["prevent"])},{default:t(()=>[s(z,{modelValue:C(l),"onUpdate:modelValue":r[0]||(r[0]=e=>L(l)?l.value=e:null),clearable:"",type:"text",color:"primary",placeholder:"Type your message !","clear-icon":"tabler-circle-x"},null,8,["modelValue"]),s(U,{type:"submit",style:{padding:"10px"},size:"medium",color:"primary"},{default:t(()=>[s($,{start:"",icon:"tabler-send"}),H("Send ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{ye as default};
