import{_ as z}from"./AppTextField-803105de.js";import{q as E,L as O,a4 as j,s as V,t as S,r as u,a as q,o as r,f as i,e,b as s,d as o,E as p,z as l,ag as F,a1 as h,H as v,a2 as H,ac as J,G as a}from"./index-670bda14.js";import{_ as L}from"./Loading-0e8ee1a0.js";import{a as C,V as R}from"./VRow-44af3a5b.js";import{V as M}from"./VCardText-83b6dd60.js";import{V as Y}from"./VDataTable-674b624c.js";import{V as T}from"./VTooltip-4a06c0c7.js";import{V as K}from"./VImg-4f1dd734.js";import{V as k}from"./VChip-c9c9bc7b.js";import{V as Q}from"./VCard-367227de.js";import"./focus-bfe812d1.js";import"./VTextField-babd124d.js";/* empty css                   */import"./VCounter-40602143.js";import"./VField-eebd85ff.js";import"./easing-9f15041e.js";import"./VInput-28c68c55.js";import"./form-f40ca62b.js";import"./forwardRefs-8348545e.js";import"./VAvatar-eedc1aa8.js";import"./VSelect-80bd1ff2.js";import"./VList-faf63776.js";import"./ssrBoot-587632ee.js";import"./VDivider-964da8ec.js";import"./dialog-transition-a3b422c0.js";import"./VMenu-cbe945a0.js";import"./VOverlay-9bca4c5f.js";import"./lazy-055ec9ba.js";import"./scopeId-78466d19.js";import"./VCheckboxBtn-770097af.js";import"./VSelectionControl-798a6484.js";import"./VTable-3015d60e.js";import"./filter-9f13f1fe.js";const W={class:"d-flex align-center"},X={class:"d-flex flex-column ms-3"},Z={class:"d-block font-weight-medium text-truncate text-high-emphasis"},tt={class:"text-xs"},et={class:"text-xs"},st={class:"text-xs"},ot={class:"text-xs"},at={class:"text-xs"},rt={class:"text-xs"},Ot={__name:"index",setup(it){const c=E(),y=O(),N=j.useToast();V(()=>document.title="Client - Supports"),V(()=>c.dispatch("GetSupports"));const A=S(()=>c.state.supports.data),I=S(()=>c.state.supports.loading),G=S(()=>c.state.auth.user),_=JSON.parse(G.value.permissions);V(()=>{var d;(d=_.SupportTicket)!=null&&d.includes("ReadSupportTicket")||(alert("You don't have permission to access this resource..."),y.go(-1))});const f=u("");u(""),u(null),u(!1),u({}),u();const P=[{title:"Assign To",key:"support.assign_to"},{title:"Title",key:"support.title"},{title:"Description",key:"support.description"},{title:"Department",key:"support.department"},{title:"Priority",key:"support.priority"},{title:"Resolution Summary",key:"support.resolution_summary"},{title:"Status",key:"support.status"},{title:"Action",key:"support.action",sortable:!1}],U=async d=>{if(confirm("Are you sure to delete ?"))try{const n=await c.dispatch("DeleteSupport",d);n.status===200&&(N.error(n.message),c.dispatch("GetSupports"))}catch(n){console.log(n)}};return(d,n)=>{const $=z,g=q("IconBtn");return r(),i(R,null,{default:e(()=>[I.value?(r(),i(L,{key:0})):(r(),i(C,{key:1,cols:"12"},{default:e(()=>[s(Q,null,{default:e(()=>{var b;return[s(M,{style:{"border-bottom":"thin solid rgba(var(--v-border-color), var(--v-border-opacity))"}},{default:e(()=>[s(R,null,{default:e(()=>[s(C,{cols:"8",md:"8"},{default:e(()=>{var t;return[o("h2",null,[p("Support Tickets "),(t=l(_).SupportTicket)!=null&&t.includes("CreateSupportTicket")?(r(),i(F,{key:0,to:"/client/support/create",rounded:"pill",color:"primary",size:"small",class:"ml-5"},{default:e(()=>[s(h,{start:"",icon:"tabler-plus"}),p(" Create ")]),_:1})):v("",!0)])]}),_:1}),s(C,{cols:"4",md:"4"},{default:e(()=>[s($,{modelValue:l(f),"onUpdate:modelValue":n[0]||(n[0]=t=>H(f)?f.value=t:null),density:"compact",placeholder:"Search ...","append-inner-icon":"tabler-search","single-line":"","hide-details":"",dense:"",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),s(l(Y),{headers:P,items:A.value,search:l(f),"items-per-page":5,class:"text-no-wrap mb-4"},J({"item.support.assign_to":e(({item:t})=>{var m,x,D,w,B;return[o("div",W,[o("div",null,[s(K,{rounded:"",src:((x=(m=t.assigned)==null?void 0:m.image)==null?void 0:x.length)>0?(D=t.assigned)==null?void 0:D.image:"/placeholder.jpg",height:"40",width:"40"},null,8,["src"])]),o("div",X,[o("span",Z,a((w=t.assigned)==null?void 0:w.name),1),o("span",tt,a((B=t.assigned)==null?void 0:B.designation),1)])])]}),"item.support.title":e(({item:t})=>[o("span",et,a(t.title),1)]),"item.support.description":e(({item:t})=>[o("span",st,a(t.message),1)]),"item.support.department":e(({item:t})=>[o("span",ot,a(t.department),1)]),"item.support.priority":e(({item:t})=>[o("span",at,a(t.priority),1)]),"item.support.resolution_summary":e(({item:t})=>[o("span",rt,a(t.resolution_summary),1)]),"item.support.status":e(({item:t})=>[t.status==="Open"?(r(),i(k,{key:0,color:"primary"},{default:e(()=>[p(a(t.status),1)]),_:2},1024)):t.status==="Pending"?(r(),i(k,{key:1,color:"primary"},{default:e(()=>[p(a(t.status),1)]),_:2},1024)):t.status==="Resolved"?(r(),i(k,{key:2,color:"success"},{default:e(()=>[p(a(t.status),1)]),_:2},1024)):t.status==="Closed"?(r(),i(k,{key:3,color:"error"},{default:e(()=>[p(a(t.status),1)]),_:2},1024)):v("",!0)]),_:2},[(b=l(_).SupportTicket)!=null&&b.includes("UpdateSupportTicket")?{name:"item.support.action",fn:e(({item:t})=>{var m;return[s(g,{onClick:()=>l(y).push("/client/support/edit/"+t.id)},{default:e(()=>[s(T,{activator:"parent",location:"top"},{default:e(()=>[p("Update")]),_:1}),s(h,{icon:"tabler-edit"})]),_:2},1032,["onClick"]),s(g,{onClick:()=>l(y).push("/client/support/chat/"+t.id)},{default:e(()=>[s(T,{activator:"parent",location:"top"},{default:e(()=>[p("Chat")]),_:1}),s(h,{icon:"tabler-message-circle"})]),_:2},1032,["onClick"]),(m=l(_).SupportTicket)!=null&&m.includes("DeleteSupportTicket")?(r(),i(g,{key:0,onClick:x=>U(t.id)},{default:e(()=>[s(T,{activator:"parent",location:"top"},{default:e(()=>[p("Delete")]),_:1}),s(h,{icon:"tabler-trash"})]),_:2},1032,["onClick"])):v("",!0)]}),key:"0"}:void 0]),1032,["items","search"])]}),_:1})]),_:1}))]),_:1})}}};export{Ot as default};
