import{r as _}from"./validators-dea6e3a5.js";import{q as x,a4 as B,L as F,s as C,t as b,r as v,o as c,f as p,e as a,b as t,d as m,ag as q,a1 as S,E as h,D as N,z as r,G as z}from"./index-c4e71550.js";import{_ as E}from"./AppTextField-a8f30c8f.js";import{_ as M}from"./Loading-2eec0421.js";import{a as i,V as y}from"./VRow-3a397f81.js";import{V as g}from"./VCardText-6669d6f5.js";import{V as U}from"./VDivider-aef533a2.js";import{V as $}from"./VForm-617abc97.js";import{V as j}from"./VCard-71b3ac17.js";import"./helpers-61e4df1a.js";import"./focus-ba6d54b4.js";import"./VTextField-47e6f93c.js";/* empty css                   */import"./VCounter-856e1893.js";import"./VImg-8451f417.js";import"./VField-0f4003e5.js";import"./easing-9f15041e.js";import"./VInput-6532c874.js";import"./form-d2acef44.js";import"./forwardRefs-8348545e.js";import"./VAvatar-0d338c12.js";const A=m("div",null,[m("h2",null,"Create Requests")],-1),ue={__name:"create",setup(G){const n=x(),w=B.useToast(),f=F();C(()=>document.title="Client - Create Requests ");const u=b(()=>n.state.subscriptionCancellations.loading),D=b(()=>n.state.auth.user),R=JSON.parse(D.value.permissions);C(()=>{var e;(e=R.CancellationRequests)!=null&&e.includes("CreateCancellationRequests")||(alert("You don't have permission to access this resource..."),f.go(-1))});const l=v(),o=v({title:"",description:""}),k=()=>{var e;(e=l==null?void 0:l.value)==null||e.validate().then(({valid:s})=>{s&&T()})},T=async()=>{const e=new FormData;e.append("title",o.value.title),e.append("description",o.value.description);try{const s=await n.dispatch("CreateSubscriptionCancellations",e);s.status===200&&(w.success(s.message),f.push("/client/subscription/cancellation/requests"))}catch(s){console.error(s)}};return(e,s)=>{const V=E;return c(),p(y,null,{default:a(()=>[u.value?(c(),p(M,{key:0})):(c(),p(i,{key:1,cols:"12"},{default:a(()=>[t(j,null,{default:a(()=>[t(g,{style:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},{default:a(()=>[A,m("div",null,[t(q,{to:"/client/subscription/cancellation/requests",rounded:"pill",color:"primary",size:"small",class:"ml-5"},{default:a(()=>[t(S,{start:"",icon:"tabler-arrow-left"}),h("Back ")]),_:1})])]),_:1}),t(U),t(g,{class:"pt-0"},{default:a(()=>[t($,{class:"mt-6",ref_key:"refForm",ref:l,onSubmit:N(k,["prevent"])},{default:a(()=>[t(y,null,{default:a(()=>[t(i,{md:"12",cols:"12"},{default:a(()=>[t(V,{"prepend-inner-icon":"tabler-user",modelValue:r(o).title,"onUpdate:modelValue":s[0]||(s[0]=d=>r(o).title=d),placeholder:"Title","persistent-placeholder":"",label:"Title",rules:["requiredValidator"in e?e.requiredValidator:r(_)]},null,8,["modelValue","rules"])]),_:1}),t(i,{md:"12",cols:"12"},{default:a(()=>[t(V,{"prepend-inner-icon":"tabler-note",modelValue:r(o).description,"onUpdate:modelValue":s[1]||(s[1]=d=>r(o).description=d),placeholder:"Description","persistent-placeholder":"",label:"Description",rules:["requiredValidator"in e?e.requiredValidator:r(_)]},null,8,["modelValue","rules"])]),_:1}),t(i,{cols:"12"},{default:a(()=>[t(q,{type:"submit",disabled:u.value},{default:a(()=>[h(z(u.value?"Creating...":"Create"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1}))]),_:1})}}};export{ue as default};
