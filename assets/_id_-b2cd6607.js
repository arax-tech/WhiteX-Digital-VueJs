import{r as p}from"./validators-dea6e3a5.js";import{q as I,n as P,L as z,a4 as E,s as S,t as d,a0 as G,r as b,o as m,f as c,e as o,b as r,d as f,ag as q,a1 as L,E as U,D as j,z as l,G as H}from"./index-35d4c811.js";import{_ as J}from"./AppTextarea-f5dca398.js";import{_ as O}from"./AppSelect-676dfa2f.js";import{_ as Y}from"./AppTextField-e0d36e66.js";import{_ as x}from"./Loading-891177bd.js";import{a as i,V as h}from"./VRow-d67d386c.js";import{V as k}from"./VCardText-20e2d0ff.js";import{V as K}from"./VDivider-4423ace3.js";import{V as Q}from"./VForm-790819b5.js";import{V as W}from"./VCard-06d56730.js";import"./helpers-61e4df1a.js";import"./focus-47cc4c1d.js";/* empty css                   */import"./VCounter-dcd2da2a.js";import"./VImg-9b04c05e.js";import"./VField-4ee07b6e.js";import"./easing-9f15041e.js";import"./VInput-ff4d0189.js";import"./form-ff0dacbf.js";import"./forwardRefs-8348545e.js";import"./VSelect-bf5a5be9.js";import"./VTextField-9bfa6dc1.js";import"./VList-56d7996c.js";import"./ssrBoot-c2946fb8.js";import"./VAvatar-7759ad5c.js";import"./dialog-transition-5411c7b8.js";import"./VMenu-d6c3699e.js";import"./VOverlay-ec7a9eab.js";import"./lazy-4836c696.js";import"./scopeId-d5f41359.js";import"./VCheckboxBtn-d7c7ca98.js";import"./VSelectionControl-4d8986cc.js";import"./VChip-5a7d2631.js";const X=f("div",null,[f("h2",null,"Update Support")],-1),Ne={__name:"[id]",setup(Z){const n=I(),V=P(),_=z(),w=E.useToast();S(()=>document.title="Client - Update Support");const T=d(()=>n.state.singleSupport.loading),y=d(()=>n.state.supports.loading),D=d(()=>n.state.singleSupport.data);G(async()=>{await n.dispatch("GetSingleSupport",V.params.id),C()});const B=d(()=>n.state.auth.user),F=JSON.parse(B.value.permissions);S(()=>{var e;(e=F.SupportTicket)!=null&&e.includes("UpdateSupportTicket")||(alert("You don't have permission to access this resource..."),_.go(-1))});const C=()=>{const e=D.value;e&&(t.value.title=e.title,t.value.message=e.message,t.value.department=e.department,t.value.priority=e.priority,t.value.resolution_summary=e.resolution_summary)},u=b(),t=b({title:"",message:"",department:"",priority:"",resolution_summary:""}),M=["Technical Support","Customer Service","Billing Inquiries","Product Feedback","Sales Inquiry"],R=["Low","Medium","High"],N=()=>{var e;(e=u==null?void 0:u.value)==null||e.validate().then(({valid:a})=>{a&&$()})},$=async()=>{const e=new FormData;e.append("title",t.value.title),e.append("message",t.value.message),e.append("department",t.value.department),e.append("priority",t.value.priority),e.append("resolution_summary",t.value.resolution_summary);try{const a=await n.dispatch("UpdateSupport",{id:V.params.id,formData:e});a.status===200&&(w.success(a.message),_.push("/client/support"))}catch(a){console.error(a)}};return(e,a)=>{const g=Y,v=O,A=J;return m(),c(h,null,{default:o(()=>[T.value?(m(),c(x,{key:0})):(m(),c(i,{key:1,cols:"12"},{default:o(()=>[r(W,null,{default:o(()=>[r(k,{style:{display:"flex","flex-direction":"row","align-items":"center","justify-content":"space-between"}},{default:o(()=>[X,f("div",null,[r(q,{to:"/client/support",rounded:"pill",color:"primary",size:"small",class:"ml-5"},{default:o(()=>[r(L,{start:"",icon:"tabler-arrow-left"}),U("Back ")]),_:1})])]),_:1}),r(K),r(k,{class:"pt-0"},{default:o(()=>[r(Q,{class:"mt-6",ref_key:"refForm",ref:u,onSubmit:j(N,["prevent"])},{default:o(()=>[r(h,null,{default:o(()=>[r(i,{md:"6",cols:"12"},{default:o(()=>[r(g,{"prepend-inner-icon":"tabler-note",modelValue:l(t).title,"onUpdate:modelValue":a[0]||(a[0]=s=>l(t).title=s),placeholder:"Title","persistent-placeholder":"",label:"Title",rules:["requiredValidator"in e?e.requiredValidator:l(p)]},null,8,["modelValue","rules"])]),_:1}),r(i,{md:"6",cols:"12"},{default:o(()=>[r(g,{"prepend-inner-icon":"tabler-message",modelValue:l(t).message,"onUpdate:modelValue":a[1]||(a[1]=s=>l(t).message=s),placeholder:"Message","persistent-placeholder":"",label:"Message",rules:["requiredValidator"in e?e.requiredValidator:l(p)]},null,8,["modelValue","rules"])]),_:1}),r(i,{md:"6",cols:"12"},{default:o(()=>[r(v,{modelValue:l(t).department,"onUpdate:modelValue":a[2]||(a[2]=s=>l(t).department=s),items:M,"prepend-inner-icon":"tabler-color-picker",label:"Department",rules:["requiredValidator"in e?e.requiredValidator:l(p)]},null,8,["modelValue","rules"])]),_:1}),r(i,{md:"6",cols:"12"},{default:o(()=>[r(v,{modelValue:l(t).priority,"onUpdate:modelValue":a[3]||(a[3]=s=>l(t).priority=s),items:R,"prepend-inner-icon":"tabler-color-picker",label:"Priority",rules:["requiredValidator"in e?e.requiredValidator:l(p)]},null,8,["modelValue","rules"])]),_:1}),r(i,{md:"12",cols:"12"},{default:o(()=>[r(A,{"prepend-inner-icon":"tabler-message-2",modelValue:l(t).resolution_summary,"onUpdate:modelValue":a[4]||(a[4]=s=>l(t).resolution_summary=s),placeholder:"Resolution Summary","persistent-placeholder":"",label:"Resolution Summary",rules:["requiredValidator"in e?e.requiredValidator:l(p)],rows:"3"},null,8,["modelValue","rules"])]),_:1}),r(i,{cols:"12"},{default:o(()=>[r(q,{type:"submit",disabled:y.value},{default:o(()=>[U(H(y.value?"Updating...":"Update"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1}))]),_:1})}}};export{Ne as default};
