import{r as h}from"./validators-dea6e3a5.js";import{s as k,q as j,a4 as q,t as b,r as u,o as C,f as E,e as l,b as a,D as G,z as s,d,ag as x,a1 as N,E as P,G as B}from"./index-c4e71550.js";import{_ as R}from"./AppTextField-a8f30c8f.js";import{V as T}from"./VCard-71b3ac17.js";import{V as z}from"./VForm-617abc97.js";import{V as y}from"./VCardText-6669d6f5.js";import{V as M}from"./VAvatar-0d338c12.js";import{V as S}from"./VDivider-aef533a2.js";import{V as D,a as c}from"./VRow-3a397f81.js";import"./helpers-61e4df1a.js";import"./focus-ba6d54b4.js";import"./VTextField-47e6f93c.js";/* empty css                   */import"./VCounter-856e1893.js";import"./VImg-8451f417.js";import"./VField-0f4003e5.js";import"./easing-9f15041e.js";import"./VInput-6532c874.js";import"./form-d2acef44.js";import"./forwardRefs-8348545e.js";const L={class:"d-flex flex-column justify-center gap-4"},$={class:"d-flex flex-wrap gap-2"},J=d("span",{class:"d-none d-sm-block"},"Upload new photo",-1),K=d("p",{class:"text-body-1 mb-0"}," Allowed JPG, GIF or PNG. Max size of 800K ",-1),ge={__name:"profile",setup(H){var v;k(()=>document.title="Admin - Profile");const m=j(),w=q.useToast(),n=b(()=>m.state.auth.user),g=b(()=>m.state.auth.loading),o=u({name:n.value.name,email:n.value.email,image:null}),I={avatarImg:(v=n==null?void 0:n.value)==null?void 0:v.image,name:"john",email:"johnDoe@example.com"},V=u(),f=u(structuredClone(I)),U=t=>{const e=new FileReader,{files:r}=t.target;r&&r.length&&(o.value.image=r[0],e.readAsDataURL(r[0]),e.onload=()=>{typeof e.result=="string"&&(f.value.avatarImg=e.result)})},p=u(),A=t=>{var e;t.preventDefault(),(e=p==null?void 0:p.value)==null||e.validate().then(({valid:r})=>{r&&F()})},F=async()=>{const t=new FormData;t.append("name",o.value.name),t.append("email",o.value.email),o.value.image&&t.append("image",o.value.image);try{const e=await m.dispatch("UpdateProfileAction",t);e.status===200&&(m.dispatch("GetAuthUser"),w.success(e.message))}catch(e){console.error(e)}};return(t,e)=>{const r=R;return C(),E(D,null,{default:l(()=>[a(c,{cols:"12"},{default:l(()=>[a(T,{title:"Profile Details"},{default:l(()=>[a(z,{ref_key:"refForm",ref:p,onSubmit:G(A,["prevent"])},{default:l(()=>[a(y,{class:"d-flex"},{default:l(()=>{var i;return[a(M,{rounded:"",size:"100",class:"me-6",image:((i=s(f).avatarImg)==null?void 0:i.length)>0?s(f).avatarImg:"/placeholder.jpg"},null,8,["image"]),d("div",L,[d("div",$,[a(x,{color:"primary",onClick:e[0]||(e[0]=O=>{var _;return(_=s(V))==null?void 0:_.click()})},{default:l(()=>[a(N,{icon:"tabler-cloud-upload",class:"d-sm-none"}),J]),_:1}),d("input",{ref_key:"refInputEl",ref:V,type:"file",name:"image",accept:".jpeg,.png,.jpg,GIF",hidden:"",onInput:U},null,544)]),K])]}),_:1}),a(S),a(y,{class:"pt-2"},{default:l(()=>[a(D,{class:"mt-6"},{default:l(()=>[a(c,{md:"6",cols:"12"},{default:l(()=>[a(r,{"prepend-inner-icon":"tabler-user",placeholder:"Name",name:"name",modelValue:s(o).name,"onUpdate:modelValue":e[1]||(e[1]=i=>s(o).name=i),"persistent-placeholder":"",label:"Name",rules:["requiredValidator"in t?t.requiredValidator:s(h)]},null,8,["modelValue","rules"])]),_:1}),a(c,{md:"6",cols:"12"},{default:l(()=>[a(r,{"prepend-inner-icon":"tabler-mail",placeholder:"Email",name:"email",modelValue:s(o).email,"onUpdate:modelValue":e[2]||(e[2]=i=>s(o).email=i),"persistent-placeholder":"",label:"Email",rules:["requiredValidator"in t?t.requiredValidator:s(h)]},null,8,["modelValue","rules"])]),_:1}),a(c,{cols:"12",class:"d-flex flex-wrap gap-4"},{default:l(()=>[a(x,{type:"submit",disabled:g.value},{default:l(()=>[P(B(g.value?"Updating...":"Update"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})}}};export{ge as default};
