import{_ as tt}from"./AppSelect-b4b316a2.js";import{_ as et}from"./DialogCloseBtn-07a65624.js";import{_ as st}from"./AppTextField-803105de.js";import{q as lt,L as ot,a4 as at,s as $,t as M,r as k,a as nt,o as u,f as m,e,b as a,z as n,a2 as w,d as s,G as d,E as b,H as T,a1 as F,c as S,D as it,ag as dt}from"./index-670bda14.js";import{_ as rt}from"./Loading-0e8ee1a0.js";import{h as y}from"./moment-a9aaa855.js";import{a as r,V as f}from"./VRow-44af3a5b.js";import{V as O}from"./VCardText-83b6dd60.js";import{V as ct}from"./VDataTable-674b624c.js";import{V as D}from"./VChip-c9c9bc7b.js";import{V as R}from"./VTooltip-4a06c0c7.js";import{V as ut}from"./VDialog-e50ee805.js";import{V as G}from"./VCard-367227de.js";import{V as _t,a as B}from"./VTabs-d671518a.js";import{V as pt,a as E}from"./VWindowItem-2688b9cd.js";import{V as bt}from"./VForm-e3bcef70.js";import"./focus-bfe812d1.js";import"./VSelect-80bd1ff2.js";import"./VTextField-babd124d.js";/* empty css                   */import"./VCounter-40602143.js";import"./VImg-4f1dd734.js";import"./VField-eebd85ff.js";import"./easing-9f15041e.js";import"./VInput-28c68c55.js";import"./form-f40ca62b.js";import"./forwardRefs-8348545e.js";import"./VList-faf63776.js";import"./ssrBoot-587632ee.js";import"./VAvatar-eedc1aa8.js";import"./VDivider-964da8ec.js";import"./dialog-transition-a3b422c0.js";import"./VMenu-cbe945a0.js";import"./VOverlay-9bca4c5f.js";import"./lazy-055ec9ba.js";import"./scopeId-78466d19.js";import"./VCheckboxBtn-770097af.js";import"./VSelectionControl-798a6484.js";import"./VTable-3015d60e.js";import"./filter-9f13f1fe.js";import"./VSlideGroup-4c7ec14a.js";const mt=s("h2",null,"Subscriptions",-1),ht={class:"text-xs"},ft={class:"text-xs"},gt={class:"text-xs"},xt={class:"text-xs"},yt={class:"text-xs"},vt={class:"text-xs"},Vt={style:{"margin-top":"10px"}},kt=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Subscription",-1),wt=s("br",null,null,-1),St={class:"mb-1"},Dt=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Item ",-1),Ct=s("br",null,null,-1),Mt={class:"mb-1"},Tt=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Total ",-1),Ut=s("br",null,null,-1),$t={class:"mb-1"},Bt=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Start Date",-1),Et=s("br",null,null,-1),It={class:"mb-1"},Pt=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Next Payment ",-1),At=s("br",null,null,-1),Nt={class:"mb-1"},Ft=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"End Date ",-1),Ot=s("br",null,null,-1),Rt={class:"mb-1"},Gt=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Status",-1),Ht=s("br",null,null,-1),Wt={key:0,style:{padding:"2px 10px"},class:"rounded bg-secondary"},qt={key:1,style:{padding:"2px 10px"},class:"rounded bg-info"},zt={key:2,style:{padding:"2px 10px"},class:"rounded bg-warning"},Jt={key:3,style:{padding:"2px 10px"},class:"rounded bg-success"},Lt={key:4,style:{padding:"2px 10px","background-color":"#c72c2c",color:"#fff"},class:"rounded bg-red"},Yt=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Full Name",-1),jt=s("br",null,null,-1),Kt={class:"mb-1"},Qt=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Company ",-1),Xt=s("br",null,null,-1),Zt={class:"mb-1"},te=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Email ",-1),ee=s("br",null,null,-1),se={class:"mb-1"},le=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Phone ",-1),oe=s("br",null,null,-1),ae={class:"mb-1"},ne=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"City ",-1),ie=s("br",null,null,-1),de={class:"mb-1"},re=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"State ",-1),ce=s("br",null,null,-1),ue={class:"mb-1"},_e=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Country ",-1),pe=s("br",null,null,-1),be={class:"mb-1"},me=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Post Code ",-1),he=s("br",null,null,-1),fe={class:"mb-1"},ge=s("label",{class:"text-h6 text-overline mb-1 font-weight-bolder"},"Full Address ",-1),xe=s("br",null,null,-1),ye={class:"mb-1"},ve=s("br",null,null,-1),cs={__name:"index",setup(Ve){const g=lt(),H=ot(),W=at.useToast();$(()=>document.title="Admin - Subscriptions"),$(()=>g.dispatch("GetSubscriptions"));const q=M(()=>g.state.subscriptions.subscriptions),z=M(()=>g.state.subscriptions.plans),U=M(()=>g.state.subscriptions.loading),v=k(!1),V=k(null),J=M(()=>g.state.auth.user),I=JSON.parse(J.value.permissions);$(()=>{var _;(_=I.Subscription)!=null&&_.includes("ReadSubscription")||(alert("You don't have permission to access this resource..."),H.go(-1))});const C=k(""),L=[{title:"Subscription",key:"subscription.subscription"},{title:"Item",key:"subscription.items"},{title:"Total",key:"subscription.total"},{title:"Start Date",key:"subscription.start_date"},{title:"Next Payment",key:"subscription.next_payment"},{title:"End Date",key:"subscription.end_date"},{title:"Status",key:"subscription.status"},{title:"Action",key:"subscription.action",sortable:!1}],i=k(null),Y=_=>{var c;v.value=!0,i.value=_,V.value=(c=_==null?void 0:_.line_items[0])==null?void 0:c.name},P=()=>{v.value=!1,i.value=null},j=_=>{window.open(_,"_blank")},K=async()=>{var _;try{const c=await g.dispatch("UpdateSubscriptionAction",{subscriptionId:(_=i.value)==null?void 0:_.id,planId:V.value});g.dispatch("GetSubscriptions"),W.success("Subscription Update Successfully..."),P()}catch(c){console.log(c)}},x=k("Tab1");return(_,c)=>{const Q=st,A=nt("IconBtn"),X=et,Z=tt;return u(),m(f,null,{default:e(()=>[U.value?(u(),m(rt,{key:0})):(u(),m(r,{key:1,cols:"12"},{default:e(()=>[a(G,null,{default:e(()=>[a(O,{style:{"border-bottom":"thin solid rgba(var(--v-border-color), var(--v-border-opacity))"}},{default:e(()=>[a(f,null,{default:e(()=>[a(r,{cols:"8",md:"8"},{default:e(()=>[mt]),_:1}),a(r,{cols:"4",md:"4"},{default:e(()=>[a(Q,{modelValue:n(C),"onUpdate:modelValue":c[0]||(c[0]=l=>w(C)?C.value=l:null),density:"compact",placeholder:"Search ...","append-inner-icon":"tabler-search","single-line":"","hide-details":"",dense:"",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(n(ct),{headers:L,items:q.value,search:n(C),"items-per-page":5,class:"text-no-wrap mb-4"},{"item.subscription.subscription":e(({item:l})=>{var t,o;return[s("span",ht,d(l==null?void 0:l.id)+" for "+d(`${(t=l==null?void 0:l.user)==null?void 0:t.first_name} ${(o=l==null?void 0:l.user)==null?void 0:o.last_name}`),1)]}),"item.subscription.items":e(({item:l})=>{var t;return[s("span",ft,d((t=l==null?void 0:l.line_items[0])==null?void 0:t.name),1)]}),"item.subscription.total":e(({item:l})=>{var t;return[s("span",gt,d((t=l==null?void 0:l.line_items[0])==null?void 0:t.subtotal)+" / "+d(l==null?void 0:l.billing_period),1)]}),"item.subscription.start_date":e(({item:l})=>[s("span",xt,d(l!=null&&l.start_date_gmt?n(y)(l==null?void 0:l.start_date_gmt).format("DD MMM yyyy"):"-"),1)]),"item.subscription.next_payment":e(({item:l})=>[s("span",yt,d(l!=null&&l.end_date_gmt?n(y)(l==null?void 0:l.end_date_gmt).format("DD MMM yyyy"):"-"),1)]),"item.subscription.end_date":e(({item:l})=>[s("span",vt,d(l!=null&&l.end_date_gmt?n(y)(l==null?void 0:l.end_date_gmt).format("DD MMM yyyy"):"-"),1)]),"item.subscription.status":e(({item:l})=>[l.status==="pending-cancel"?(u(),m(D,{key:0,color:"secondary"},{default:e(()=>[b("Pending Cancel")]),_:1})):l.status==="expired"?(u(),m(D,{key:1,color:"info"},{default:e(()=>[b("Expired")]),_:1})):l.status==="on-hold"?(u(),m(D,{key:2,color:"warning"},{default:e(()=>[b("On Hold")]),_:1})):l.status==="active"?(u(),m(D,{key:3,color:"success"},{default:e(()=>[b("Active")]),_:1})):l.status==="cancelled"?(u(),m(D,{key:4,color:"error"},{default:e(()=>[b("Cancelled")]),_:1})):T("",!0)]),"item.subscription.action":e(({item:l})=>[a(A,{onClick:t=>Y(l)},{default:e(()=>[a(R,{activator:"parent",location:"top"},{default:e(()=>[b("View Subscription Details")]),_:1}),a(F,{icon:"tabler-eye"})]),_:2},1032,["onClick"]),a(A,{onClick:t=>{var o;return j("https://whitexdigital.com/product/"+((o=l==null?void 0:l.line_items[0])==null?void 0:o.product_id))}},{default:e(()=>[a(R,{activator:"parent",location:"top"},{default:e(()=>[b("View Package")]),_:1}),a(F,{icon:"tabler-id"})]),_:2},1032,["onClick"]),n(i)?(u(),m(ut,{key:0,modelValue:n(v),"onUpdate:modelValue":c[4]||(c[4]=t=>w(v)?v.value=t:null),width:"1000"},{default:e(()=>[a(X,{onClick:P}),a(G,{title:"Subscription Details"},{default:e(()=>[s("div",Vt,[a(_t,{modelValue:n(x),"onUpdate:modelValue":c[1]||(c[1]=t=>w(x)?x.value=t:null)},{default:e(()=>{var t;return[a(B,null,{default:e(()=>[b("Details")]),_:1}),a(B,null,{default:e(()=>[b("Billing Info")]),_:1}),(t=n(I).Subscription)!=null&&t.includes("UpdateSubscription")?(u(),m(B,{key:0},{default:e(()=>[b(" Upgrade Downgrade Subscription")]),_:1})):T("",!0)]}),_:1},8,["modelValue"]),a(O,null,{default:e(()=>[a(pt,{modelValue:n(x),"onUpdate:modelValue":c[3]||(c[3]=t=>w(x)?x.value=t:null)},{default:e(()=>[a(E,{value:"Tab1"},{default:e(()=>[a(f,null,{default:e(()=>[a(r,{cols:"4"},{default:e(()=>{var t,o,p,h,N;return[kt,wt,s("label",St,"#"+d((t=n(i))==null?void 0:t.id)+" for "+d(`${(p=(o=n(i))==null?void 0:o.user)==null?void 0:p.first_name}
                                                            ${(N=(h=n(i))==null?void 0:h.user)==null?void 0:N.last_name}`),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o;return[Dt,Ct,s("label",Mt,d((o=(t=n(i))==null?void 0:t.line_items[0])==null?void 0:o.name),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o,p;return[Tt,Ut,s("label",$t,d((o=(t=n(i))==null?void 0:t.line_items[0])==null?void 0:o.subtotal)+" / "+d((p=n(i))==null?void 0:p.billing_period),1)]}),_:1})]),_:1}),a(f,null,{default:e(()=>[a(r,{cols:"4"},{default:e(()=>{var t,o;return[Bt,Et,s("label",It,d((t=n(i))!=null&&t.start_date_gmt?n(y)((o=n(i))==null?void 0:o.start_date_gmt).format("DD MMM yyyy"):"-"),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o;return[Pt,At,s("label",Nt,d((t=n(i))!=null&&t.end_date_gmt?n(y)((o=n(i))==null?void 0:o.end_date_gmt).format("DD MMM yyyy"):"-"),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o;return[Ft,Ot,s("label",Rt,d((t=n(i))!=null&&t.end_date_gmt?n(y)((o=n(i))==null?void 0:o.end_date_gmt).format("DD MMM yyyy"):"-"),1)]}),_:1})]),_:1}),a(f,null,{default:e(()=>[a(r,{cols:"12"},{default:e(()=>[Gt,Ht,n(i).status==="pending-cancel"?(u(),S("span",Wt,"Pending Cancel")):n(i).status==="expired"?(u(),S("span",qt,"Expired")):n(i).status==="on-hold"?(u(),S("span",zt,"On Hold")):n(i).status==="active"?(u(),S("span",Jt,"Active")):n(i).status==="cancelled"?(u(),S("span",Lt,"Cancelled")):T("",!0)]),_:1})]),_:1})]),_:1}),a(E,{value:"Tab2"},{default:e(()=>[a(f,null,{default:e(()=>[a(r,{cols:"4"},{default:e(()=>{var t,o,p,h;return[Yt,jt,s("label",Kt,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.first_name)+" "+d((h=(p=n(i))==null?void 0:p.billing)==null?void 0:h.last_name),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o;return[Qt,Xt,s("label",Zt,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.company),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o;return[te,ee,s("label",se,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.email),1)]}),_:1})]),_:1}),a(f,null,{default:e(()=>[a(r,{cols:"4"},{default:e(()=>{var t,o;return[le,oe,s("label",ae,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.phone),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o;return[ne,ie,s("label",de,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.city),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o;return[re,ce,s("label",ue,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.state),1)]}),_:1})]),_:1}),a(f,null,{default:e(()=>[a(r,{cols:"4"},{default:e(()=>{var t,o;return[_e,pe,s("label",be,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.country),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o;return[me,he,s("label",fe,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.postcode),1)]}),_:1}),a(r,{cols:"4"},{default:e(()=>{var t,o,p,h;return[ge,xe,s("label",ye,d((o=(t=n(i))==null?void 0:t.billing)==null?void 0:o.address_1)+", "+d((h=(p=n(i))==null?void 0:p.billing)==null?void 0:h.address_2),1)]}),_:1})]),_:1})]),_:1}),a(E,{value:"Tab3"},{default:e(()=>[a(bt,{onSubmit:it(K,["prevent"]),class:"p-2"},{default:e(()=>[a(Z,{modelValue:n(V),"onUpdate:modelValue":c[2]||(c[2]=t=>w(V)?V.value=t:null),items:z.value,"item-title":"name","item-value":"id",label:"Select Plan","prepend-inner-icon":"tabler-color-picker","persistent-placeholder":"",placeholder:"Choose.."},null,8,["modelValue","items"]),ve,a(dt,{type:"submit",disabled:U.value},{default:e(()=>[b(d(U.value?"Updating...":"Update"),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1},8,["modelValue"])):T("",!0)]),_:1},8,["items","search"])]),_:1})]),_:1}))]),_:1})}}};export{cs as default};
